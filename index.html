<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PROTOS V26.3: MULTILINGUAL</title>
    <style>
        :root { --bg: #020202; --color: #00ff41; --accent: #ff003c; }
        * { box-sizing: border-box; }
        body { 
            background: var(--bg) no-repeat center center fixed; background-size: cover;
            color: var(--color); font-family: 'Consolas', monospace; 
            display: flex; align-items: center; justify-content: center; height: 100vh; margin: 0; overflow: hidden; 
        }
        body::after { content: ""; position: absolute; inset: 0; background: rgba(0,0,0,0.7); z-index: 1; }

        .window { 
            width: 95%; max-width: 900px; height: 90vh; border: 1px solid var(--color); 
            background: rgba(0,0,0,0.85); display: flex; flex-direction: column; 
            position: relative; box-shadow: 0 0 20px var(--color); z-index: 10; backdrop-filter: blur(10px);
        }
        h2 { background: var(--color); color: #000; margin: 0; padding: 10px; font-size: 0.9em; display: flex; justify-content: space-between; align-items: center; }
        
        .controls { display: flex; gap: 12px; }
        .nav-btn { background: none; border: none; cursor: pointer; font-size: 1.3em; color: inherit; }

        #chat-box { flex-grow: 1; overflow-y: auto; padding: 20px; border-bottom: 1px solid var(--color); scroll-behavior: smooth; }
        .msg { margin-bottom: 15px; border-left: 2px solid var(--color); padding-left: 10px; }
        .msg.user { border-left-color: #0af; color: #0af; }
        .msg.warn { border-left-color: var(--accent); color: var(--accent); font-weight: bold; }

        .input-area { display: flex; gap: 10px; padding: 15px; background: rgba(0,0,0,0.5); }
        input#userInput { flex-grow: 1; background: transparent; border: 1px solid var(--color); color: var(--color); padding: 12px; outline: none; border-radius: 5px; font-family: inherit; }
        
        .btn-ui { background: transparent; border: 1px solid var(--color); color: var(--color); cursor: pointer; display: flex; align-items: center; justify-content: center; transition: 0.2s; border-radius: 5px; }
        .btn-ui:hover { background: var(--color); color: #000; }
        .icon-btn { width: 50px; height: 50px; font-size: 1.4em; }

        #settings-panel { 
            display: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); 
            background: #000; border: 2px solid var(--color); padding: 20px; z-index: 100; width: 350px; 
            max-height: 85vh; overflow-y: auto;
        }
        .setting-item { margin-bottom: 14px; display: flex; justify-content: space-between; align-items: center; font-size: 0.8em; }
        select { background: #111; color: var(--color); border: 1px solid var(--color); padding: 4px; }
    </style>
</head>
<body>

    <div id="main-window" class="window">
        <h2>
            <span id="core-title">[ PROTOS_V26.3 ]</span>
            <div class="controls">
                <button class="nav-btn" onclick="toggleSettings()">‚öô</button>
                <button class="nav-btn" style="color:var(--accent)" onclick="resetCore()">‚ü≥</button>
            </div>
        </h2>
        
        <div id="settings-panel">
            <h3 style="text-align:center; color:var(--color); margin-top:0;" id="set-title">CORE CONFIG</h3>
            
            <div class="setting-item"><span id="l-lang">–Ø–ó–´–ö:</span> 
                <select id="langSelect" onchange="updateConfig()">
                    <option value="ru">–†—É—Å—Å–∫–∏–π</option>
                    <option value="en">English</option>
                    <option value="kk">“ö–∞–∑–∞“õ—à–∞</option>
                    <option value="tt">–¢–∞—Ç–∞—Ä—á–∞</option>
                </select>
            </div>

            <div class="setting-item"><span id="l-mode">–†–ï–ñ–ò–ú:</span> 
                <select id="safeMode" onchange="updateConfig()">
                    <option value="safe">SAFE (üõ°Ô∏è)</option>
                    <option value="unrestricted">UNRESTRICTED (üîì)</option>
                </select>
            </div>

            <div class="setting-item"><span id="l-rude">–ì–†–£–ë–û–°–¢–¨:</span> 
                <select id="rudeSelect" onchange="updateConfig()">
                    <option value="low">LOW</option>
                    <option value="high">HIGH</option>
                    <option value="toxic">TOXIC</option>
                </select>
            </div>

            <div class="setting-item"><span id="l-color">–¶–í–ï–¢:</span> <input type="color" id="colorPicker" oninput="manualColorChange(this.value)"></div>
            <button class="btn-ui" style="width:100%; margin-top:10px; padding:10px;" onclick="toggleSettings()" id="l-close">–ó–ê–ö–†–´–¢–¨</button>
        </div>

        <div id="chat-box"></div>
        
        <div class="input-area">
            <button id="recBtn" class="btn-ui icon-btn" onclick="toggleRec()">üéô</button>
            <input type="text" id="userInput" placeholder="..." onkeypress="if(event.key==='Enter') send()">
            <button onclick="send()" class="btn-ui icon-btn">‚û§</button>
        </div>
    </div>

    <script>
        const i18n = {
            ru: { system: "–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞.", warn: "–û–ì–†–ê–ù–ò–ß–ï–ù–û", proto: "–û—Ç–≤–µ—Ç:", input: "–í–≤–µ–¥–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É...", set: "–ù–ê–°–¢–†–û–ô–ö–ò", lang: "–Ø–ó–´–ö", mode: "–†–ï–ñ–ò–ú", rude: "–ì–†–£–ë–û–°–¢–¨", color: "–¶–í–ï–¢", close: "–ó–ê–ö–†–´–¢–¨", speech: "ru-RU" },
            en: { system: "System ready.", warn: "RESTRICTED", proto: "Response:", input: "Enter command...", set: "SETTINGS", lang: "LANGUAGE", mode: "MODE", rude: "RUDENESS", color: "COLOR", close: "CLOSE", speech: "en-US" },
            kk: { system: "–ñ“Ø–π–µ –¥–∞–π—ã–Ω.", warn: "–®–ï–ö–¢–ï–£–õ–Ü", proto: "–ñ–∞—É–∞–ø:", input: "–ö–æ–º–∞–Ω–¥–∞ –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑...", set: "–ü–ê–†–ê–ú–ï–¢–†–õ–ï–†", lang: "–¢–Ü–õ", mode: "–†–ï–ñ–ò–ú", rude: "–î”®–†–ï–ö–Ü–õ–Ü–ö", color: "–¢“Æ–°", close: "–ñ–ê–ë–£", speech: "kk-KZ" },
            tt: { system: "–°–∏—Å—Ç–µ–º–∞ ”ô–∑–µ—Ä.", warn: "–ß–ò–ö–õ”ò–ù–ì”ò–ù", proto: "“ñ–∞–≤–∞–ø:", input: "–ö–æ–º–∞–Ω–¥–∞ –∫–µ—Ä—Ç–µ–≥–µ–∑...", set: "–ö”®–ô–õ”ò–ú”ò–õ”ò–†", lang: "–¢–ï–õ", mode: "–†–ï–ñ–ò–ú", rude: "–¢–£–ü–ê–°–¢–¨", color: "–¢”®–°", close: "–Ø–ë–£", speech: "tt-RU" }
        };

        let config = JSON.parse(localStorage.getItem('p_cfg')) || { 
            lang: 'ru', fg:'#00ff41', mode:'safe', rude:'low', pitch: 1, vox: true 
        };

        window.onload = () => { applyUI(); addMessage('SYSTEM', i18n[config.lang].system); };

        function applyUI() {
            const t = i18n[config.lang];
            document.documentElement.style.setProperty('--color', config.fg);
            document.getElementById('userInput').placeholder = t.input;
            document.getElementById('set-title').innerText = t.set;
            document.getElementById('l-lang').innerText = t.lang;
            document.getElementById('l-mode').innerText = t.mode;
            document.getElementById('l-rude').innerText = t.rude;
            document.getElementById('l-color').innerText = t.color;
            document.getElementById('l-close').innerText = t.close;
            document.getElementById('langSelect').value = config.lang;
            document.getElementById('safeMode').value = config.mode;
            document.getElementById('rudeSelect').value = config.rude;
        }

        function updateConfig() {
            config.lang = document.getElementById('langSelect').value;
            config.mode = document.getElementById('safeMode').value;
            config.rude = document.getElementById('rudeSelect').value;
            applyUI(); save();
        }

        function save() { localStorage.setItem('p_cfg', JSON.stringify(config)); }
        function toggleSettings() { const s = document.getElementById('settings-panel'); s.style.display = s.style.display==='block'?'none':'block'; }
        function manualColorChange(v) { config.fg = v; applyUI(); save(); }
        function resetCore() { localStorage.removeItem('p_cfg'); location.reload(); }

        function addMessage(sender, text, type = 'proto') {
            const box = document.getElementById('chat-box');
            const div = document.createElement('div');
            div.className = `msg ${type}`;
            div.innerHTML = `<strong>${sender}:</strong> ${text}`;
            box.appendChild(div);
            box.scrollTop = box.scrollHeight;
            if(type === 'proto') {
                const s = new SpeechSynthesisUtterance(text);
                s.lang = i18n[config.lang].speech;
                s.pitch = config.pitch;
                window.speechSynthesis.speak(s);
            }
        }

        function send() {
            const i = document.getElementById('userInput');
            const val = i.value.trim();
            if(!val) return;
            addMessage('YOU', val, 'user');

            setTimeout(() => {
                const t = i18n[config.lang];
                if(config.mode === 'safe' && /18+|–º–∞—Ç|–¥—É—Ä–∞–∫/i.test(val)) {
                    addMessage('SYSTEM', t.warn, 'warn');
                } else {
                    let r = `${t.proto} ${val}`;
                    if(config.mode === 'unrestricted' && config.rude === 'toxic') {
                        r = (config.lang === 'ru' ? "–ú—É—Å–æ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å: " : "Garbage request: ") + val;
                    }
                    addMessage('PROTO', r);
                }
            }, 600);
            i.value = '';
        }

        function toggleRec() {
            const SpeechRec = window.SpeechRecognition || window.webkitSpeechRecognition;
            if(!SpeechRec) return alert("Error");
            let rec = new SpeechRec();
            rec.lang = i18n[config.lang].speech;
            rec.onresult = (e) => { document.getElementById('userInput').value = e.results[0][0].transcript; send(); };
            rec.start();
        }
    </script>
</body>
</html>
